<p>
 The following examples demonstrate common practices for handling CFD data.
</p>
<h4>
 Example 1: Buy And Hold
</h4>
<p>
 The following algorithm is a buy-and-hold strategy on the DE30EUR CFD contract. We only place orders when quote data is available to avoid stale fills. Also, we set the algorithm time zone to Berlin and the account currency to Euros for a more convenient comparison.
</p>
<div class="section-example-container testable">
 <pre class="csharp">public class CfdExampleAlgorithm : QCAlgorithm
{
    private Symbol _dax, _sgx;

    public override void Initialize()
    {
        SetStartDate(2024, 9, 1);
        SetEndDate(2024, 12, 31);
        // Set the timezone as Berlin to conveniently compare the data.
        SetTimeZone(TimeZones.Berlin);
        // Set the account currency to EUR to trade the DAX CFD.
        SetAccountCurrency("EUR", 10000);
        // Request the CFD data to trade.
        _dax = AddCfd("DE30EUR").Symbol;
        _sgx = AddCfd("SG30SGD").Symbol;
    }

    public override void OnData(Slice slice)
    {
        // Trade based on updated data; CFDs only have quote data.
        if (slice.QuoteBars.TryGetValue(_dax, out var _))
        {
            // Buy and hold DAX CFD.
            if (!Portfolio[_dax].IsLong)
            {
                SetHoldings(_dax, 0.5m);
            }
        }
    }
}</pre>
<pre class="python">class CfdExampleAlgorithm(QCAlgorithm):
    def initialize(self) -&gt; None:
        self.set_start_date(2024, 9, 1)
        self.set_end_date(2024, 12, 31)
        # Set the timezone as Berlin to conveniently compare the data.
        self.set_time_zone(TimeZones.BERLIN)
        # Set the account currency to EUR to trade the DAX CFD.
        self.set_account_currency("EUR", 10000)
        # Request the CFD data to trade.
        self._dax = self.add_cfd("DE30EUR").symbol

    def on_data(self, slice: Slice) -&gt; None:
        # Trade based on updated data; CFDs only have quote data.
        bar = slice.quote_bars.get(self._dax)
        if bar:
            # Buy and hold DAX CFD.
            if not self.portfolio[self._dax].is_long:
                self.set_holdings(self._dax, 0.5)</pre>
</div>
<h4>
 Example 2: Global Indices
</h4>
<p>
 The following algorithm buys and holds various Index CFDs that trade in different market hours and currencies during their opening hours.
</p>
<div class="section-example-container testable">
 <pre class="csharp">public class CfdExampleAlgorithm : QCAlgorithm
{
    public override void Initialize()
    {
        SetStartDate(2024, 9, 1);
        SetEndDate(2024, 12, 31);
        // Seed the price of each asset with its last known price to 
        // avoid trading errors.
        SetSecurityInitializer(
            new BrokerageModelSecurityInitializer(
                BrokerageModel, new FuncSecuritySeeder(GetLastKnownPrices)
            )
        );
        // Let's select CFD contracts that trade in different market 
        // hours so the algorithm is always invested.
        foreach (var ticker in new[] { "DE30EUR", "SG30SGD", "US30USD" })
        {
            // Add the CFD.
            var symbol = AddCfd(ticker).Symbol;
            // Set scheduled events to hold each CFD contract during 
            // their regular trading hours.
            // Buy after market open.
            Schedule.On(
                DateRules.EveryDay(symbol),
                TimeRules.AfterMarketOpen(symbol, 1),
                () => SetHoldings(symbol, 0.3m)
            );
            // Liquidate before market close.
            Schedule.On(
                DateRules.EveryDay(symbol),
                TimeRules.BeforeMarketClose(symbol, 1),
                () => Liquidate(symbol)
            );
        }
    }
}</pre>
<pre class="python">class CfdExampleAlgorithm(QCAlgorithm):
    
    def initialize(self) -> None:
        self.set_start_date(2024, 9, 1)
        self.set_end_date(2024, 12, 31)
        # Seed the price of each asset with its last known price to 
        # avoid trading errors.
        self.set_security_initializer(
            BrokerageModelSecurityInitializer(
                self.brokerage_model, 
                FuncSecuritySeeder(self.get_last_known_prices)
            )
        )
        # Let's select CFD contracts that trade in different market 
        # hours so the algorithm is always invested.
        for ticker in ['DE30EUR', 'SG30SGD', 'US30USD']:
            # Add the CFD.
            symbol = self.add_cfd(ticker).symbol
            # Set scheduled events to hold each CFD contract during 
            # their regular trading hours.
            # Buy after market open.
            self.schedule.on(
                self.date_rules.every_day(symbol),
                self.time_rules.after_market_open(symbol, 1),
                lambda symbol=symbol: self.set_holdings(symbol, 0.3)
            )
            # Liquidate before market close.
            self.schedule.on(
                self.date_rules.every_day(symbol),
                self.time_rules.before_market_close(symbol, 1),
                lambda symbol=symbol: self.liquidate(symbol)
            )
</pre>
</div>
