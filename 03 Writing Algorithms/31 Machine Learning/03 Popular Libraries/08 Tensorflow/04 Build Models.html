<p>In this example, build a neural-network regression prediction model that uses the following features and labels:</p>

<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Category</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Features</td>
            <td>The last 5 close price differencing compared to current price</td>
        </tr>
        <tr>
            <td>Labels</td>
            <td>The following day's price change</td>
        </tr>
    </tbody>
</table>

<p>The following image shows the time difference between the features and labels:</p>
<img class="docs-image" alt="Features and labels for training" src="https://cdn.quantconnect.com/i/tu/ml-keras-function.png">

<p>Follow these steps to create a method to build the model:</p>
<ol>
    <li>Set the number of layers, their number of nodes, the number of epoch and the learning rate.</li>
    <div class="section-example-container">
        <pre class="python">num_factors = 5
num_neurons_1 = 10
num_neurons_2 = 20
num_neurons_3 = 5
self.epochs = 20
self.learning_rate = 0.0001</pre>
    </div>
    
    <li>Create the model using in-built Keras API.</li>
    <div class="section-example-container">
        <pre class="python">self.model = tf.keras.sequential([
    tf.keras.layers.dense(num_neurons_1, activation=tf.nn.relu, input_shape=(num_factors,)),  # input shape required
    tf.keras.layers.dense(num_neurons_2, activation=tf.nn.relu),
    tf.keras.layers.dense(num_neurons_3, activation=tf.nn.relu),
    tf.keras.layers.dense(1)
])</pre>
    </div>
</ol>