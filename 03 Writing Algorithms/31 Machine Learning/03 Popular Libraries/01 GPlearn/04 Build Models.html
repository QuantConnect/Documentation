<p>In this example, build a genetic programming feature transformation model and a genetic programming regression prediction model using the following features and labels:</p>

<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Category</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Features</td>
            <td>Daily percent change of the close price of the SPY over the last 5 days</td>
        </tr>
        <tr>
            <td>Labels</td>
            <td>Daily percent return of the SPY over the next day</td>
        </tr>
    </tbody>
</table>

<p>The following image shows the time difference between the features and labels:</p>
<img class="docs-image" alt="Features and labels for training" src="https://cdn.quantconnect.com/i/tu/ml-keras-function.png">

<p>Follow these steps to create a method to build the model:</p>

<ol>
    <li>Declare a set of functions to use for feature engineering.</li>
    <div class="section-example-container">
        <pre class="python">function_set = ['add', 'sub', 'mul', 'div',
                'sqrt', 'log', 'abs', 'neg', 'inv',
                'max', 'min']</pre>
    </div>

    <li>Call the <code>SymbolicTransformer</code> constructor with the preceding set of functions and then save it as a class variable.</li>
    <div class="section-example-container">
        <pre class="python">self.gp_transformer = SymbolicTransformer(function_set=function_set)</pre>
    </div>

    <li>Call the <code>SymbolicRegressor</code> constructor to instantiate the regression model.</li>
    <div class="section-example-container">
        <pre class="python">self.model = SymbolicRegressor()</pre>
    </div>
</ol>
