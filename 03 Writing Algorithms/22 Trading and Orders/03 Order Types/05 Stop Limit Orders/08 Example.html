<p>The following backtest verifies the <code class="csharp">StopLimitOrder</code><code class="python">stop_limit_order</code> behavior. The following table shows the trades in the backtest:</p>

<table class="qc-table table" id="research-nodes-table">
    <thead>
        <tr>
            <th>Submitted Time</th>
            <th>Filled Time</th>
            <th>Symbol</th>
            <th>Stop Price</th>
            <th>Limit Price</th>
            <th>Filled Price</th>
            <th>Quantity</th>
            <th>Type</th>
            <th>Status</th>
            <th>Value</th>
            <th>Tag</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>2021-07-01T09:31:00Z</td>
            <td>2021-07-01T09:37:00Z</td>
            <td>SPY</td>
            <td>428.95</td>
            <td>429.00</td>
            <td>429.00</td>
            <td>-10</td>
            <td>Stop Limit</td>
            <td>Filled</td>
            <td>-4290.00</td>
            <td>Stop Price: 造428.95 Limit Price: 造429.00</td>
        </tr>
        <tr>
            <td>2021-07-02T09:31:00Z</td>
            <td>2021-07-02T10:12:00Z</td>
            <td>SPY</td>
            <td>431.80</td>
            <td>431.75</td>
            <td>431.75</td>
            <td>10</td>
            <td>Stop Limit</td>
            <td>Filled</td>
            <td>4317.50</td>
            <td>Stop Price: 造431.80 Limit Price: 造431.75</td>
        </tr>
    </tbody>
</table>

<style>
#research-nodes-table td:nth-child(4), 
#research-nodes-table th:nth-child(4), 
#research-nodes-table td:nth-child(5), 
#research-nodes-table th:nth-child(5), 
#research-nodes-table td:nth-child(6), 
#research-nodes-table th:nth-child(6), 
#research-nodes-table td:nth-child(7), 
#research-nodes-table th:nth-child(7),
#research-nodes-table td:nth-child(10), 
#research-nodes-table th:nth-child(10) {
    text-align: right;
}
</style>

<p>On July 1, 2021 at 9:31 AM Eastern Time (ET), the algorithm places a stop limit order to sell SPY with a stop price of $428.95 and a limit price of $429. At the time of the order submission, the ask high price is $429.16 and the ask close price is $429.11. The order fills at 9:37 AM ET at a price of $429. The <a href="/docs/v2/writing-algorithms/reality-modeling/trade-fills/supported-models/immediate-model#06-Stop-Limit-Orders">fill model</a> triggers the stop for buy orders when the ask high price is greater than the stop price, fills the order when the ask close price is less than the limit price, and sets the fill price to the maximum of the ask high price and the limit price. <br></p><p>On July 2, 2021 at 9:31 AM ET, the algorithm places a stop limit order to buy SPY with a stop price of $431.80 and a limit price of $431.75. At the time of the order submissions, the bid low price is $431.49 and the bid close price is $431.54. The order fills at 10:12 AM ET at a price of $431.75. The fill model triggers the stop for sell orders when bid low price is less than the stop price, fills the order when the ask close price is less than the limit price, and sets the fill price to the minimum of the ask high price and the limit price.<br></p>


<p>To reproduce these results, backtest the following algorithm:</p><div class="python"><div class="qc-embed-frame" style="display: inline-block; position: relative; width: 100%; min-height: 100px; min-width: 300px;"><div class="qc-embed-dummy" style="padding-top: 56.25%;"></div><div class="qc-embed-element" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0;"><iframe class="qc-embed-backtest" src="https://www.quantconnect.com/terminal/processCache?request=embedded_backtest_01d0bfcdebd35217be261690c4a7826d.html" style="max-width: calc(100vw - 30px); max-height: 100vw; overflow: hidden;" scrolling="no" width="100%" height="100%"></iframe></div></div></div>

<div class="csharp"><div class="qc-embed-frame" style="display: inline-block; position: relative; width: 100%; min-height: 100px; min-width: 300px;"><div class="qc-embed-dummy" style="padding-top: 56.25%;"></div><div class="qc-embed-element" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0;"><iframe class="qc-embed-backtest" src="https://www.quantconnect.com/terminal/processCache?request=embedded_backtest_d999dfbab5c609568d01645e5865e836.html" style="max-width: calc(100vw - 30px); max-height: 100vw; overflow: hidden;" scrolling="no" width="100%" height="100%"></iframe></div></div></div>

<p>For more examples, see the following algorithms:</p>

  <div class="example-fieldset"> 
    <div class="example-legend">Demonstration Algorithms</div>
    
    <a class="python example-algorithm-link" href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.Python/StopLimitOrderRegressionAlgorithm.py" target="_BLANK">
        StopLimitOrderRegressionAlgorithm.py <span class="badge-python pull-right">Python</span>
    </a>
    
    <a class="csharp example-algorithm-link" href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.CSharp/StopLimitOrderRegressionAlgorithm.cs" target="_BLANK">
        StopLimitOrderRegressionAlgorithm.cs <span class="badge-csharp pull-right">C#</span>
    </a>
  </div>
