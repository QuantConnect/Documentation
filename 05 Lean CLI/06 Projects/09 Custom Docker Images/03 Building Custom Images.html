<p>
    Follow these steps to build custom LEAN Docker images using the CLI:
</p>

<ol>
    <li>Create a new directory that will hold the LEAN repository and the Alpha Streams SDK repository.</li>
    <li>Clone the <a href="https://github.com/QuantConnect/Lean" target="_blank">QuantConnect/Lean</a> GitHub repository using <code>git</code> or download and extract the latest <a href="https://github.com/QuantConnect/Lean/archive/refs/heads/master.zip" target="_blank">master branch archive</a>. Save this repository to a directory called <code>Lean</code> in the directory created in step 1.</li>
    <li>Clone the <a href="https://github.com/QuantConnect/alphastreams" target="_blank">QuantConnect/AlphaStreams</a> GitHub repository using <code>git</code> or download and extract the latest <a href="https://github.com/QuantConnect/AlphaStreams/archive/refs/heads/master.zip" target="_blank">master branch archive</a>. Save this repository to a directory called <code>AlphaStreams</code> in the directory created in step 1.</li>
    <li>Make your changes to LEAN.</li>
    <li>Open a terminal in the directory created in step 1.</li>
    <li>Run <code>lean build</code> to build the foundation image, compile LEAN, compile the Alpha Streams SDK, build the engine image, and build the research image.
<div class="cli section-example-container">
<pre>$ lean build
Building 'lean-cli/foundation:latest' from '/home/johndoe/QuantConnect/Lean/DockerfileLeanFoundation'
Compiling the C# code in '/home/johndoe/QuantConnect/Lean'
Compiling the C# code in '/home/johndoe/QuantConnect/AlphaStreams'
Building 'lean-cli/engine:latest' from '/home/johndoe/QuantConnect/Lean/Dockerfile' using 'lean-cli/foundation:latest' as base image
Building 'lean-cli/research:latest' from '/home/johndoe/QuantConnect/Lean/DockerfileJupyter' using 'lean-cli/engine:latest' as base image
Setting default engine image to 'lean-cli/engine:latest'
Setting default research image to 'lean-cli/research:latest'
</pre>
</div>
        After running this command the CLI uses your newly built images instead of the official ones.
    </li>
</ol>

<p>
    By default the <code>lean build</code> command tags all custom images with <code>latest</code>.
    You can specify a different tag using the <code>--tag &lt;value&gt;</code> option.
</p>

<p>
    If you haven't changed the foundation Dockerfile, the CLI automatically skips building the custom foundation image and uses the official <code>quantconnect/lean:foundation</code> image instead.
</p>
