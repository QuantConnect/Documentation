<p>When you place Crypto trades, don't use the <code>CalculateOrderQuantity</code> or <code>SetHoldings</code> methods. Instead, calculate the order quantity based on the currency amounts in your cash book and place manual orders.</p>

<p>The following code snippet demonstrates how to allocate 90% of the portfolio to BTC.</p>

<div class="section-example-container">
<pre class="csharp"></pre>
<pre class="python">target_quantity = 0.9 * self.Portfolio.TotalPortfolioValue / self.Securities["BTCUSD"].Price
quantity = target_quantity - self.Portfolio.CashBook['BTC'].Amount
self.MarketOrder("BTCUSD", quantity) </pre>
</div>


<p>The following example demonstrates how to form an equal-weighted Crypto portfolio, while considering the <a href='/docs/v2/writing-algorithms/trading-and-orders/position-sizing#05-Buying-Power-Buffer'>cash buffer</a>.</p>

<div class="section-example-container">
<pre class="csharp"></pre>
<pre class="python">usd_per_symbol = self.Portfolio.CashBook['USD'].Amount * (1 - self.cash_buffer) / len(self.symbols)
for symbol in self.symbols:
    self.MarketOrder(symbol, usd_per_symbol / data[symbol].Price) </pre>
</div>

<p>When you place Crypto trades, ensure you have a sufficient balance of the base or quote currency before each trade. The preceding example assume all of your portfolio capital is in USD. If you hold multiple assets and you want to put all of your capital into BTCUSD, you need to first convert all your non-BTC assets into USD and then purchase BTCUSD.</p>

<p>For a full example of placing crypto trades, see the <span class="python"><a href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.Python/BasicTemplateCryptoAlgorithm.py">BasicTemplateCryptoAlgorithm</a></span><span class="csharp"><a href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.CSharp/BasicTemplateCryptoAlgorithm.cs">BasicTemplateCryptoAlgorithm</a></span>.</p>
