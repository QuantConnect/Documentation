<p>To send a MOC order, call the <code>MarketOnCloseOrder</code> method with a <code>Symbol</code> and quantity. If you don't have sufficient capital for the order, it is rejected.<br></p>

<div class="section-example-container">
<pre class="csharp">// Buy 100 shares of AAPL at the market open
MarketOnCloseOrder("AAPL", 100);

// Sell 100 shares of AAPL at the market open
MarketOnCloseOrder("AAPL", -100);</pre>
<pre class="python"># Buy 100 shares of AAPL at the market open
self.MarketOnCloseOrder("AAPL", 100)

# Sell 100 shares of AAPL at the market open
self.MarketOnCloseOrder("AAPL", -100)</pre>
</div>

<p>You can provide a tag and <a href="/docs/v2/writing-algorithms/trading-and-orders/order-properties">order properties</a> to the <code>MarketOnCloseOrder</code> method.</p>
<div class="section-example-container">
<pre class="csharp">MarketOnCloseOrder(symbol, quantity, tag: tag, orderProperties: orderProperties);</pre>
<pre class="python">self.MarketOnCloseOrder(symbol, quantity, tag=tag, orderProperties=order_properties)</pre>
</div>

<p>By default, you must place MOC orders at least 15.5 minutes before the close, but some exchanges let you submit them closer to the market closing time. To adjust the buffer period that's required, set the <code>MarketOnCloseOrder.SubmissionTimeBuffer</code> property.</p>

<div class="section-example-container">
<pre class="csharp">Orders.MarketOnCloseOrder.SubmissionTimeBuffer = TimeSpan.FromMinutes(10);</pre>
<pre class="python">MarketOnCloseOrder.SubmissionTimeBuffer = timedelta(minutes=10)</pre>
</div>
